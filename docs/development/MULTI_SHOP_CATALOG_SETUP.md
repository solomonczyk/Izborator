# üè™ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–ª—è –í–°–ï–• –º–∞–≥–∞–∑–∏–Ω–æ–≤

## –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–µ—Ä –∫–∞—Ç–∞–ª–æ–≥–æ–≤ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è **–≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤**, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ Gigatron!

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### –®–∞–≥ 1: –û–±–Ω–æ–≤–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤—Å–µ—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤

```bash
ssh root@152.53.227.37
cd ~/Izborator

# –í—ã–ø–æ–ª–Ω–∏ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
docker exec -i izborator_postgres psql -U postgres -d izborator < backend/scripts/update_all_shops_catalog.sql
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```bash
docker exec izborator_postgres psql -U postgres -d izborator -c \
  "SELECT name, selectors->>'catalog_url' as catalog_url FROM shops WHERE is_active = true;"
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã:
- ‚úÖ Gigatron
- ‚úÖ Tehnomanija
- –ò –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω—ã

### –®–∞–≥ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ worker

```bash
docker-compose restart worker
docker-compose logs -f worker
```

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

Worker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. **–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤**
2. **–î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞:**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ `catalog_url` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
   - –ï—Å–ª–∏ –Ω–µ—Ç - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `base_url` –∫–∞–∫ —Ç–æ—á–∫—É –≤—Ö–æ–¥–∞
   - –û–±—Ö–æ–¥–∏—Ç –∫–∞—Ç–∞–ª–æ–≥ –∏ –Ω–∞—Ö–æ–¥–∏—Ç —Ç–æ–≤–∞—Ä—ã
   - –ü–∞—Ä—Å–∏—Ç –∫–∞–∂–¥—ã–π –Ω–∞–π–¥–µ–Ω–Ω—ã–π —Ç–æ–≤–∞—Ä
3. **–†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ SQL

```sql
INSERT INTO shops (id, name, code, base_url, is_active, selectors, rate_limit)
VALUES (
    '–Ω–æ–≤—ã–π-uuid',
    '–ù–∞–∑–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞',
    '–∫–æ–¥-–º–∞–≥–∞–∑–∏–Ω–∞',
    'https://–º–∞–≥–∞–∑–∏–Ω.rs',
    true,
    '{
        "name": "—Å–µ–ª–µ–∫—Ç–æ—Ä-–Ω–∞–∑–≤–∞–Ω–∏—è",
        "price": "—Å–µ–ª–µ–∫—Ç–æ—Ä-—Ü–µ–Ω—ã",
        "image": "—Å–µ–ª–µ–∫—Ç–æ—Ä-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è",
        "catalog_url": "https://–º–∞–≥–∞–∑–∏–Ω.rs/–∫–∞—Ç–µ–≥–æ—Ä–∏—è",
        "catalog_product_link": ".—Å–µ–ª–µ–∫—Ç–æ—Ä-—Ç–æ–≤–∞—Ä–∞ a",
        "catalog_next_page": ".—Å–µ–ª–µ–∫—Ç–æ—Ä-—Å–ª–µ–¥—É—é—â–µ–π-—Å—Ç—Ä–∞–Ω–∏—Ü—ã"
    }'::jsonb,
    2
);
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –º–∞–≥–∞–∑–∏–Ω

```sql
UPDATE shops
SET selectors = selectors || '{
    "catalog_url": "https://–º–∞–≥–∞–∑–∏–Ω.rs/–∫–∞—Ç–µ–≥–æ—Ä–∏—è",
    "catalog_product_link": ".product-item a",
    "catalog_next_page": ".pagination .next"
}'::jsonb
WHERE id = 'ID_–ú–ê–ì–ê–ó–ò–ù–ê';
```

## –ö–∞–∫ –Ω–∞–π—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã

1. **–û—Ç–∫—Ä–æ–π –∫–∞—Ç–∞–ª–æ–≥ –º–∞–≥–∞–∑–∏–Ω–∞** –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `https://gigatron.rs/mobilni-telefoni`)
2. **–û—Ç–∫—Ä–æ–π DevTools** (F12)
3. **–ù–∞–π–¥–∏ —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–æ–≤–∞—Ä** –∏ –ø–æ—Å–º–æ—Ç—Ä–∏ –µ—ë —Å—Ç—Ä—É–∫—Ç—É—Ä—É
4. **–°–∫–æ–ø–∏—Ä—É–π CSS —Å–µ–ª–µ–∫—Ç–æ—Ä** (–ø—Ä–∞–≤—ã–π –∫–ª–∏–∫ ‚Üí Copy ‚Üí Copy selector)

**–ü—Ä–∏–º–µ—Ä—ã —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤:**
- Gigatron: `.product-box a`
- Tehnomanija: `.product-item a`
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ: `a[href*="/product/"]`, `.product-card a`

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π

–î–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –æ–¥–Ω–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞, –º–æ–∂–Ω–æ:

1. **–°–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π –º–∞–≥–∞–∑–∏–Ω–∞** —Å —Ä–∞–∑–Ω—ã–º–∏ `catalog_url`
2. **–ò–ª–∏ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –∫–æ–¥** –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –º–∞—Å—Å–∏–≤–∞ `catalog_urls` (–ø–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

```bash
# –°–ª–µ–¥–∏ –∑–∞ –ª–æ–≥–∞–º–∏ worker
docker-compose logs -f worker | grep -E "(catalog|discovery|shop)"

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# üîç Starting catalog discovery...
# Discovering products from catalog (shop: Gigatron, ...)
# Discovering products from catalog (shop: Tehnomanija, ...)
# Found products in catalog (shop: Gigatron, total_found: X)
# Found products in catalog (shop: Tehnomanija, total_found: Y)
```

## –¢–µ–∫—É—â–∏–µ –º–∞–≥–∞–∑–∏–Ω—ã

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –±—É–¥—É—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã:

1. **Gigatron** (`a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11`)
   - –ö–∞—Ç–∞–ª–æ–≥: `https://gigatron.rs/mobilni-telefoni`

2. **Tehnomanija** (`b0eebc99-9c0b-4ef8-bb6d-6bb9bd380b22`)
   - –ö–∞—Ç–∞–ª–æ–≥: `https://www.tehnomanija.rs/telefoni-smart-satovi-i-tableti/mobilni-telefoni`

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥—Ä—É–≥–∏—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤ –°–µ—Ä–±–∏–∏

–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω—ã –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:
- **WinWin** - `https://www.winwin.rs`
- **Tehnomedia** - `https://www.tehnomedia.rs`
- **Comtrade** - `https://www.comtrade.rs`
- **Extreme Digital** - `https://www.extreme-digital.rs`

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω—É–∂–Ω–æ:
1. –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ `shops`
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ–ª–µ–∫—Ç–æ—Ä—ã (–Ω–∞–∑–≤–∞–Ω–∏–µ, —Ü–µ–Ω–∞, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ)
3. –î–æ–±–∞–≤–∏—Ç—å `catalog_url` –∏ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –∫–∞—Ç–∞–ª–æ–≥–∞

## –ì–æ—Ç–æ–≤–æ! üéâ

–¢–µ–ø–µ—Ä—å worker –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–∞—Ä—Å–∏—Ç—å —Ç–æ–≤–∞—Ä—ã —Å–æ **–≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤**!

**–ë–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫–∏!** üöÄ

