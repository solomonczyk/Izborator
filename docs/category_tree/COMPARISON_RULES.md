# Category Source Comparison Rules

Цель: определить формальные правила сравнения нескольких донорских деревьев
(ePonuda, Google Product Taxonomy, future sources)
для формирования канонического дерева проекта.

---

## 1. Типы источников

### Structural sources
- Маркетплейсы
- Price-comparison сайты
- Локальные магазины

Пример: ePonuda

### Semantic sources
- Таксономии
- Стандарты
- Каталоги без коммерческого UI

Пример: Google Product Taxonomy

---

## 2. Приоритет источников

1. Semantic source — приоритет по названию и смыслу
2. Structural source — приоритет по глубине и пользовательской логике
3. Локальные источники — приоритет по региональным особенностям

---

## 3. Правила совпадения категорий

Категории считаются совпадающими, если:
- совпадает пользовательский смысл
- различия только в формулировке
- совпадает тип продукта

Slug и путь **не являются** решающими.

---

## 4. Объединение (Merge)

Объединяем категории, если:
- ≥2 источников подтверждают категорию
- категория логична для пользователя
- категория не противоречит семантическому источнику

---

## 5. Разделение (Split)

Разделяем категорию, если:
- источник A объединяет слишком разные сущности
- семантический источник требует разделения
- пользователь ожидает разные фильтры

---

## 6. Исключение (Drop)

Исключаем категорию, если:
- она временная или промо
- не имеет смысла вне конкретного источника
- не подтверждена другими источниками

---

## 7. Пограничные категории

Примеры:
- Erotika
- Zdravlje
- Usluge vs Roba

Решаются:
- вручную
- с пометками (`restricted`, `needs_review`)
- без автоматических merge

---

## 8. Каноническое дерево

Каноническое дерево:
- не копия ни одного источника
- результат сравнения
- расширяемо новыми источниками
- стабильно во времени

---

## 9. Документирование решений

Каждое нетривиальное решение должно:
- быть описано в map.md источника
- иметь краткое объяснение

---

## 10. Definition of Done

Правила считаются внедрёнными, если:
- можно объяснить любое решение
- можно добавить новый источник без рефакторинга
- нет “магических” ручных правок
