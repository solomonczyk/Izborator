# üîÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ Nginx –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ Izborator

## –°–∏—Ç—É–∞—Ü–∏—è

–£ –Ω–∞—Å –µ—Å—Ç—å –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞:

### –í–∞—Ä–∏–∞–Ω—Ç 1: Izborator Nginx —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç–∞—Ö 80/443 ‚úÖ (–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è)

–ï—Å–ª–∏ –Ω–∞—à Docker Nginx —É–∂–µ —É—Å–ø–µ—à–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç–∞—Ö 80/443 (–∫–∞–∫ –≤–∏–¥–Ω–æ –∏–∑ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è), —Ç–æ —Å–∏—Å—Ç–µ–º–Ω—ã–π Nginx –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω.

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
ssh root@152.53.227.37
systemctl status nginx
```

–ï—Å–ª–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–π Nginx –∑–∞–ø—É—â–µ–Ω –∏ –º–µ—à–∞–µ—Ç, –æ—Å—Ç–∞–Ω–æ–≤–∏ –µ–≥–æ:
```bash
systemctl stop nginx
systemctl disable nginx
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –°–∏—Å—Ç–µ–º–Ω—ã–π Nginx –Ω—É–∂–µ–Ω –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

–ï—Å–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –µ—Å—Ç—å –¥—Ä—É–≥–∏–µ –ø—Ä–æ–µ–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π Nginx, –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –µ–≥–æ –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ Izborator.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ Nginx (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤)

### –®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–∏—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
ssh root@152.53.227.37
```

### –®–∞–≥ 2: –ù–∞–π–¥–∏ –∫–æ–Ω—Ñ–∏–≥ Nginx

```bash
# –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥
ls -la /etc/nginx/sites-available/
ls -la /etc/nginx/sites-enabled/

# –ò–ª–∏ –≥–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥
cat /etc/nginx/nginx.conf
```

### –®–∞–≥ 3: –°–æ–∑–¥–∞–π –∫–æ–Ω—Ñ–∏–≥ –¥–ª—è Izborator

```bash
nano /etc/nginx/sites-available/izborator
```

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–Ω—Ñ–∏–≥–∞:**

```nginx
# –ö–æ–Ω—Ñ–∏–≥ –¥–ª—è Izborator
server {
    listen 80;
    server_name izborator.—Ç–≤–æ–π–¥–æ–º–µ–Ω.com;  # –ó–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π –¥–æ–º–µ–Ω/–ø–æ–¥–¥–æ–º–µ–Ω
    # –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π IP: server_name 152.53.227.37;

    # –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ HTTPS (–µ—Å–ª–∏ –µ—Å—Ç—å SSL)
    # return 301 https://$server_name$request_uri;

    # –§—Ä–æ–Ω—Ç–µ–Ω–¥ (Next.js)
    location / {
        proxy_pass http://127.0.0.1:3002;  # –ü–æ—Ä—Ç frontend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }

    # –ë—ç–∫–µ–Ω–¥ API (Go)
    location /api/ {
        proxy_pass http://127.0.0.1:8081;  # –ü–æ—Ä—Ç backend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç)
        # –ò–ª–∏ —á–µ—Ä–µ–∑ Docker network:
        # proxy_pass http://izborator_backend:8080;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

**–í–∞–∂–Ω–æ:** –ï—Å–ª–∏ –Ω–∞—à Docker Nginx —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç–∞—Ö 80/443, –Ω—É–∂–Ω–æ –ª–∏–±–æ:
- –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π Nginx
- –ò–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç—ã Docker Nginx –Ω–∞ –¥—Ä—É–≥–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 8080/8443) –∏ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Å —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ Nginx

### –®–∞–≥ 4: –ê–∫—Ç–∏–≤–∏—Ä—É–π –∫–æ–Ω—Ñ–∏–≥

```bash
# –°–æ–∑–¥–∞–π —Å–∏–º–ª–∏–Ω–∫
ln -s /etc/nginx/sites-available/izborator /etc/nginx/sites-enabled/

# –ü—Ä–æ–≤–µ—Ä—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
nginx -t

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏ Nginx
systemctl reload nginx
```

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—à Docker Nginx –Ω–∞–ø—Ä—è–º—É—é

–ï—Å–ª–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–π Nginx –Ω–µ –Ω—É–∂–µ–Ω, –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–π –Ω–∞—à Docker Nginx, –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

```bash
# –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –Ω–∞—à Nginx —Ä–∞–±–æ—Ç–∞–µ—Ç
docker ps | grep nginx

# –ü—Ä–æ–≤–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
curl http://152.53.227.37/api/health
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ —É —Ç–µ–±—è –µ—Å—Ç—å –¥–æ–º–µ–Ω:

1. **–î–æ–±–∞–≤—å A-–∑–∞–ø–∏—Å—å –≤ DNS:**
   ```
   izborator.—Ç–≤–æ–π–¥–æ–º–µ–Ω.com ‚Üí 152.53.227.37
   ```

2. **–û–±–Ω–æ–≤–∏ –∫–æ–Ω—Ñ–∏–≥ Nginx** (–≤ Docker –∏–ª–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–º):
   ```nginx
   server_name izborator.—Ç–≤–æ–π–¥–æ–º–µ–Ω.com;
   ```

3. **–ù–∞—Å—Ç—Ä–æ–π SSL —á–µ—Ä–µ–∑ Let's Encrypt:**
   ```bash
   # –í Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –∏–ª–∏ –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–º Nginx
   certbot --nginx -d izborator.—Ç–≤–æ–π–¥–æ–º–µ–Ω.com
   ```

## –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä—å:

```bash
# –ü—Ä–æ–≤–µ—Ä—å —Å—Ç–∞—Ç—É—Å Nginx
systemctl status nginx
# –∏–ª–∏
docker ps | grep nginx

# –ü—Ä–æ–≤–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
curl http://152.53.227.37/api/health
curl http://152.53.227.37/

# –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏
tail -f /var/log/nginx/error.log
# –∏–ª–∏
docker logs izborator_nginx
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–ï—Å–ª–∏ –ø–æ—Ä—Ç—ã 80/443 —Å–≤–æ–±–æ–¥–Ω—ã** (–∫–∞–∫ —Å–µ–π—á–∞—Å –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è):
- –ò—Å–ø–æ–ª—å–∑—É–π –Ω–∞—à Docker Nginx –Ω–∞–ø—Ä—è–º—É—é
- –û—Å—Ç–∞–Ω–æ–≤–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–π Nginx, –µ—Å–ª–∏ –æ–Ω –Ω–µ –Ω—É–∂–µ–Ω
- –ù–∞—Å—Ç—Ä–æ–π –¥–æ–º–µ–Ω –≤ `nginx/nginx.conf` –≤–Ω—É—Ç—Ä–∏ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

**–ï—Å–ª–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–π Nginx –Ω—É–∂–µ–Ω –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤:**
- –ù–∞—Å—Ç—Ä–æ–π —Å–∏—Å—Ç–µ–º–Ω—ã–π Nginx –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- –ò–ª–∏ –∏–∑–º–µ–Ω–∏ –ø–æ—Ä—Ç—ã Docker Nginx –∏ –ø—Ä–æ–∫—Å–∏—Ä—É–π —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—ã–π

