# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –ø–∞—Ä—Å–∏–Ω–≥–∞

## –®–∞–≥ 1: –ó–∞–ø—É—Å–∫ Docker Compose

–£–±–µ–¥–∏—Å—å, —á—Ç–æ Docker Desktop –∑–∞–ø—É—â–µ–Ω, –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏:

```bash
cd F:\Dev\Projects\Izborator
docker-compose up -d
```

–ü—Ä–æ–≤–µ—Ä—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:

```bash
docker-compose ps
```

–í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Å—Ç–∞—Ç—É—Å–µ "Up".

## –®–∞–≥ 2: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

```bash
cd backend
go run cmd/migrate/main.go -up
```

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: "Applied migration 1: 0001_initial_schema"

## –®–∞–≥ 3: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Gigatron

```bash
docker exec -i izborator_postgres psql -U postgres -d izborator < backend/scripts/seed_gigatron.sql
```

–ò–ª–∏ —á–µ—Ä–µ–∑ psql –Ω–∞–ø—Ä—è–º—É—é:

```bash
psql -U postgres -d izborator -f backend/scripts/seed_gigatron.sql
```

## –®–∞–≥ 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞

**–í–∞–∂–Ω–æ:** –£–±–µ–¥–∏—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î:

```bash
cd backend
$env:DB_PORT="5433"
$env:DB_HOST="127.0.0.1"
$env:DB_USER="postgres"
$env:DB_PASSWORD="postgres"
$env:DB_NAME="izborator"
```

–ù–∞–π–¥–∏ –ª—é–±–æ–π —Ç–æ–≤–∞—Ä –Ω–∞ —Å–∞–π—Ç–µ gigatron.rs –∏ —Å–∫–æ–ø–∏—Ä—É–π –µ–≥–æ URL, –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏:

```bash
go run cmd/worker/main.go -url "https://gigatron.rs/.../—Ç–æ–≤–∞—Ä"
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ï—Å–ª–∏ –ø–æ–ª—É—á–∞–µ—à—å 404 –æ—à–∏–±–∫—É, —ç—Ç–æ –º–æ–∂–µ—Ç –æ–∑–Ω–∞—á–∞—Ç—å, —á—Ç–æ:
- –¢–æ–≤–∞—Ä –±–æ–ª—å—à–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- URL –∏–∑–º–µ–Ω–∏–ª—Å—è
- –°–∞–π—Ç –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã (–Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å User-Agent –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫–∏)

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
- "üöÄ Starting manual test scrape..."
- "Shop config loaded"
- "Starting scraping"
- "Visiting ..."
- "‚úÖ SUCCESS! Product parsed" —Å –¥–∞–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞
- "üíæ Saved to raw_products table"

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ –ë–î

```bash
docker exec -it izborator_postgres psql -U postgres -d izborator -c "SELECT name, price, currency, url FROM raw_products ORDER BY scraped_at DESC LIMIT 5;"
```

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **Docker –Ω–µ –∑–∞–ø—É—â–µ–Ω**: –ó–∞–ø—É—Å—Ç–∏ Docker Desktop
2. **–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î**: –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã (`docker-compose ps`)
3. **–°–µ–ª–µ–∫—Ç–æ—Ä—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç**: –í–µ—Ä—Å—Ç–∫–∞ —Å–∞–π—Ç–∞ –º–æ–≥–ª–∞ –∏–∑–º–µ–Ω–∏—Ç—å—Å—è, –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –≤ –ë–î
4. **–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Ü–µ–Ω—ã**: –ü—Ä–æ–≤–µ—Ä—å —Ñ–æ—Ä–º–∞—Ç —Ü–µ–Ω—ã –Ω–∞ —Å–∞–π—Ç–µ –∏ –æ–±–Ω–æ–≤–∏ —Ñ—É–Ω–∫—Ü–∏—é `cleanPrice` –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤

–ï—Å–ª–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç, –æ–±–Ω–æ–≤–∏ –∏—Ö –≤ –ë–î:

```sql
UPDATE shops 
SET selectors = '{
    "name": "–Ω–æ–≤—ã–π_—Å–µ–ª–µ–∫—Ç–æ—Ä",
    "price": "–Ω–æ–≤—ã–π_—Å–µ–ª–µ–∫—Ç–æ—Ä_—Ü–µ–Ω—ã",
    "image": "–Ω–æ–≤—ã–π_—Å–µ–ª–µ–∫—Ç–æ—Ä_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è",
    "description": "–Ω–æ–≤—ã–π_—Å–µ–ª–µ–∫—Ç–æ—Ä_–æ–ø–∏—Å–∞–Ω–∏—è",
    "brand": "–Ω–æ–≤—ã–π_—Å–µ–ª–µ–∫—Ç–æ—Ä_–±—Ä–µ–Ω–¥–∞"
}'::jsonb
WHERE id = 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11';
```

