# ARCHITECTURE RULES — Слои и зависимости

## 1. Слои проекта (логические)

cmd/              — входные точки (api, worker)
  ↓
http/             — HTTP-обёртка, роутер, middleware
  ↓
domain/           — бизнес-логика и интерфейсы
  ↓
storage adapters/ — реализации интерфейсов domain с доступом к БД/поиску/кешу
  ↓
drivers           — Postgres, Meili, Redis и т.п.

## 2. Запрещённые зависимости (import)

- storage → http
- domain → http
- domain ↔ domain (кросс зависимости)
- http → drivers (Postgres, Meili, Redis)
- cmd → storage (и drivers) напрямую

## 3. Разрешённые зависимости (import)

✔ http → domain  
✔ storage → domain (адаптеры реализуют доменные интерфейсы)  
✔ storage → drivers  
✔ cmd → http (и/или app-композицию)  

## 4. Требования к модулям domain/*

Каждый модуль должен содержать как минимум:
- `models.go`   — доменные сущности
- `module.go`   — интерфейсы сервиса/хранилища и конструктор
- `impl.go`     — реализация сервиса
- `errors.go`   — доменные ошибки

Допустимы альтернативные имена (`service.go`, `storage.go`), если сохраняется разделение:
интерфейсы в одном месте, реализации — в другом.

## 5. Принцип "чистой" доменной логики
Домен:
- не знает ничего о Postgres
- не знает ничего о HTTP
- не содержит бизнес-кода из других модулей
